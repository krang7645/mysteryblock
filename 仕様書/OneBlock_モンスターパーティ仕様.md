# OneBlock モンスターパーティ仕様書

## 概要
- 本仕様書は、OneBlock by IJAMinecraft (1.20.6) データパックおよびMOD化を想定した「モンスターパーティ」イベントの仕様を詳細にまとめたものです。
- ゲーム進行中に発生する特殊な戦闘イベントであり、演出・mob出現・空間制御・リカバリー等を含みます。

---

## 1. 発生条件
- 一定の進行度（採掘回数）や特定フェーズ到達時、またはランダムイベントとして発生。
- フェーズ10以降やアフターフェーズでの発生が多い。
- コマンドやUI操作で強制発生・無効化も可能。

---

## 2. 演出・空間制御
- 発生時、無限ブロック周囲の一定範囲（例：5×5×5）をairでクリアし、安全な戦闘空間を確保。
- パーティクル・SE（効果音）・タイトル表示などの演出を付与。
- 必要に応じて一時的にバリアブロックで囲うことも可能。

---

## 3. 出現mob
- フェーズや進行度に応じて、出現するmobの種類・数・カスタム名・装備・タグ等が変化。
- 例：
    - フェーズ10ではendermite（2～3体）、enderman（1～2体）、shulker（1体）など。
    - mobには"Monster Guard"などのカスタムネームや特殊タグを付与。
- mobは一定時間経過後に自動消滅（例：9000tick=7.5分）や、全滅時にSE・パーティクル演出。

---

## 4. 消滅・リカバリー
- パーティ終了時、mobを強制消去し、演出を付与。
- プレイヤーが全滅した場合や一定時間経過時に自動リカバリー（例：耐性エフェクト付与、リスポーン地点へのTP等）。

---

## 5. カスタマイズ性・拡張性
- 設定ファイルやコマンドで「出現mob・数・装備・演出・空間制御」などを自由に編集可能。
- 他MODやアドオンからイベントフックで独自のパーティ演出・mob追加も可能。
- コマンドやUIで「パーティ発生ON/OFF」「即時発生」「難易度調整」なども実装可能。

---

## 6. MOD化時の設計ポイント
- パフォーマンス・同期ズレ対策として、mob管理・空間クリア・演出はサーバー側で一元管理。
- マルチプレイ時は全プレイヤーに演出・SE・タイトルを同期。
- パーティ発生中は無限ブロックの採掘を一時停止する設計も可能（設定でON/OFF）。
- mobのカスタムAIや特殊行動も拡張可能。

---

## 7. 参考：OneBlockデータパックでの実装例
- `functions/effects/party-segment-destruction.mcfunction`で空間クリア・演出を実行。
- `functions/generated/mob/`配下でパーティ用mobをスポーン。
- `functions/generated/phase/`で進行度・フェーズごとにパーティ発生管理。
- `scoreboard`や`tag`でパーティ状態・mob管理・リカバリーを制御。

---

## 8. 現段階（1.20.6）での発生条件・出現モブ詳細

### 8.1 発生条件・タイミング（実例）
- フェーズ10以降、またはアフターフェーズで一定回数ごとに自動発生。
    - 例：フェーズ10では「endermite, enderman, shulker」パーティがランダムまたは特定カウンター到達時に発生。
- 進行度（採掘回数）例：
    - 5414, 5467, 5586, 5689, 5820, 5995回目でパーティ発生（通常チェストと同タイミングで発生する場合もあり）
- コマンドやUIで「/trigger ija-a4-trigger」等により手動発生も可能。

### 8.2 出現モブ・構成例
| フェーズ | パーティ名 | 出現mob         | 数量 | カスタム名         | 備考                     |
|----------|------------|-----------------|------|--------------------|--------------------------|
| 10       | Monster Party | endermite      | 2～3 | Monster Guard      | カスタムタグ・即時攻撃型 |
| 10       | Monster Party | enderman       | 1～2 | Monster Guard      | カスタムタグ・通常AI     |
| 10       | Monster Party | shulker        | 1    | Monster Guard      | カスタムタグ・弾発射     |
| After    | Monster Party | 全フェーズmob  | ランダム | Monster Guard  | mob種・数ともに多様     |

- すべてのパーティmobには`CustomName: "Monster Guard"`や`Tags: ["ija-a4-party"]`等が付与される。
- 一部mobは装備（例：防具・武器）や特殊効果（例：耐性・スピード）を持つ場合もある。
- mobは9000tick（7.5分）経過で自動消滅。

### 8.3 その他の発生例
- アフターフェーズでは「全フェーズのmob」からランダムで複数体が同時出現。
- 特定の進行度やイベントで「特殊パーティ（例：ボス級mobや大量スポーン）」が発生することもある。

---

今後もバージョンアップやMOD化要件に応じて追記・更新します。
